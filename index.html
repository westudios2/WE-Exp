<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeExperiences - Your Guide is with WE</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    
    <!-- Leaflet CSS for Maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Google Fonts - Elegant Serif + Clean Sans -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant:wght@400;600&family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            background: #EDE7D4;
            height: 100%;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            font-size: 17px;
            line-height: 1.6em;
            letter-spacing: 2px;
            color: #924720;
            background: #EDE7D4;
            min-width: 320px;
        }
        
        .leaflet-container {
            height: 100%;
            width: 100%;
            border-radius: 0;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // ‚ö†Ô∏è REPLACE WITH YOUR FIREBASE CONFIG
        const firebaseConfig = {
            apiKey: "AIzaSyCGLoYmgIP6rs8eL2SySqyRXaC7yJT3dZM",
            authDomain: "weexperiences.firebaseapp.com",
            projectId: "weexperiences",
            storageBucket: "weexperiences.firebasestorage.app",
            messagingSenderId: "978056196148",
            appId: "1:978056196148:web:319f9a3ca1d0a257f55a61"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const storage = firebase.storage();

        const { useState, useEffect, useRef } = React;
        
        // Styles object
        const styles = {
            container: {
                minHeight: '100vh',
                background: '#EDE7D4',
            },
            header: {
                background: '#EDE7D4',
                borderBottom: '1px solid #5673B8',
                padding: '30px 40px',
                textAlign: 'center',
                position: 'sticky',
                top: 0,
                zIndex: 600,
            },
            headerTitle: {
                fontFamily: "'Cormorant', serif",
                fontSize: '2.8em',
                fontWeight: '600',
                letterSpacing: '0px',
                color: '#171742',
                marginBottom: '10px',
            },
            headerSubtitle: {
                fontFamily: "'Montserrat', sans-serif",
                fontSize: '17px',
                letterSpacing: '2px',
                color: '#924720',
                fontWeight: '400',
            },
            nav: {
                display: 'flex',
                justifyContent: 'center',
                gap: '0',
                borderBottom: '1px solid #e2e2e2',
                maxWidth: '1200px',
                margin: '40px auto 0',
                padding: '0 40px',
            },
            navButton: (isActive) => ({
                fontFamily: "'Montserrat', sans-serif",
                fontSize: '18px',
                letterSpacing: '3px',
                fontWeight: '500',
                color: isActive ? '#5673B8' : '#924720',
                background: 'none',
                border: 'none',
                borderBottom: isActive ? '2px solid #5673B8' : '2px solid transparent',
                padding: '15px 30px',
                cursor: 'pointer',
                transition: 'all 0.4s ease',
                opacity: isActive ? 1 : 0.65,
            }),
            main: {
                maxWidth: '1200px',
                margin: '0 auto',
                padding: '40px 40px 60px',
            },
            addButtonContainer: {
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                marginBottom: '40px',
            },
            button: {
                fontFamily: "'Montserrat', sans-serif",
                fontSize: '15px',
                letterSpacing: '2px',
                color: '#5673B8',
                background: '#5673B8',
                border: 'none',
                padding: '1px',
                minWidth: '160px',
                cursor: 'pointer',
                transition: 'opacity 0.4s ease',
                display: 'inline-block',
            },
            buttonInner: {
                background: '#EDE7D4',
                padding: '12px 20px',
                display: 'block',
            },
            form: {
                background: '#fff',
                padding: '40px',
                marginBottom: '40px',
                border: '1px solid #e2e2e2',
            },
            formTitle: {
                fontFamily: "'Cormorant', serif",
                fontSize: '1.8em',
                fontWeight: '600',
                color: '#171742',
                letterSpacing: '0px',
                marginBottom: '30px',
                textAlign: 'center',
            },
            label: {
                fontFamily: "'Montserrat', sans-serif",
                fontSize: '15px',
                letterSpacing: '2px',
                color: '#924720',
                fontWeight: '500',
                display: 'block',
                marginBottom: '8px',
            },
            input: {
                width: '100%',
                height: '44px',
                fontFamily: "'Montserrat', sans-serif",
                fontSize: '18px',
                letterSpacing: '2px',
                color: '#924720',
                background: 'transparent',
                border: 'none',
                borderBottom: '1px solid #e2e2e2',
                padding: '0',
                marginBottom: '20px',
                outline: 'none',
            },
            textarea: {
                width: '100%',
                minHeight: '100px',
                fontFamily: "'Montserrat', sans-serif",
                fontSize: '18px',
                lineHeight: '1.8em',
                letterSpacing: '2px',
                color: '#924720',
                background: 'transparent',
                border: 'none',
                borderBottom: '1px solid #e2e2e2',
                padding: '5px 0',
                marginBottom: '20px',
                outline: 'none',
                resize: 'vertical',
            },
            reviewCard: {
                background: '#fff',
                marginBottom: '30px',
                border: '1px solid #e2e2e2',
                overflow: 'hidden',
            },
            reviewImage: {
                width: '100%',
                height: '300px',
                objectFit: 'cover',
            },
            reviewContent: {
                padding: '30px',
            },
            reviewTitle: {
                fontFamily: "'Cormorant', serif",
                fontSize: '1.6em',
                fontWeight: '600',
                color: '#171742',
                letterSpacing: '0px',
                marginBottom: '10px',
            },
            reviewLocation: {
                fontFamily: "'Montserrat', sans-serif",
                fontSize: '15px',
                letterSpacing: '2px',
                color: '#924720',
                marginBottom: '20px',
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
            },
            reviewRating: {
                display: 'flex',
                justifyContent: 'space-between',
                alignItems: 'center',
                marginBottom: '20px',
                paddingBottom: '20px',
                borderBottom: '1px solid #e2e2e2',
            },
            reviewDescription: {
                fontFamily: "'Montserrat', sans-serif",
                fontSize: '17px',
                lineHeight: '1.6em',
                letterSpacing: '2px',
                color: '#924720',
                marginBottom: '20px',
            },
            tag: {
                display: 'inline-block',
                background: '#5673B8',
                color: '#EDE7D4',
                fontFamily: "'Montserrat', sans-serif",
                fontSize: '13px',
                letterSpacing: '1.5px',
                padding: '6px 14px',
                marginRight: '8px',
                marginBottom: '8px',
                cursor: 'pointer',
                transition: 'opacity 0.4s ease',
            },
            editDeleteButtons: {
                display: 'flex',
                gap: '10px',
                marginTop: '20px',
                paddingTop: '20px',
                borderTop: '1px solid #e2e2e2',
            },
            editButton: {
                flex: 1,
                fontFamily: "'Montserrat', sans-serif",
                fontSize: '14px',
                letterSpacing: '2px',
                color: '#5673B8',
                background: '#5673B8',
                border: 'none',
                padding: '1px',
                cursor: 'pointer',
                transition: 'opacity 0.4s ease',
            },
            deleteButton: {
                flex: 1,
                fontFamily: "'Montserrat', sans-serif",
                fontSize: '14px',
                letterSpacing: '2px',
                color: '#924720',
                background: '#924720',
                border: 'none',
                padding: '1px',
                cursor: 'pointer',
                transition: 'opacity 0.4s ease',
            },
            footer: {
                borderTop: '1px solid #5673B8',
                padding: '30px',
                textAlign: 'center',
                fontFamily: "'Montserrat', sans-serif",
                fontSize: '14px',
                letterSpacing: '2px',
                color: '#924720',
            },
        };

        const MapView = ({ reviews }) => {
            const mapRef = useRef(null);
            const mapInstanceRef = useRef(null);
            const markersRef = useRef([]);

            useEffect(() => {
                if (!mapRef.current || mapInstanceRef.current) return;
                const map = L.map(mapRef.current).setView([39.8283, -98.5795], 4);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '¬© OpenStreetMap contributors'
                }).addTo(map);
                mapInstanceRef.current = map;
                return () => {
                    if (mapInstanceRef.current) {
                        mapInstanceRef.current.remove();
                        mapInstanceRef.current = null;
                    }
                };
            }, []);

            useEffect(() => {
                if (!mapInstanceRef.current || reviews.length === 0) return;
                markersRef.current.forEach(marker => marker.remove());
                markersRef.current = [];

                const addMarkers = async () => {
                    const bounds = [];
                    for (const review of reviews) {
                        try {
                            const response = await fetch(
                                `https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(review.location)}&format=json&limit=1`
                            );
                            const data = await response.json();
                            if (data && data.length > 0) {
                                const coords = { lat: parseFloat(data[0].lat), lng: parseFloat(data[0].lon) };
                                const marker = L.marker([coords.lat, coords.lng])
                                    .bindPopup(`<div style="text-align: center;"><strong>${review.name}</strong><br/>${review.location}<br/>‚≠ê ${review.rating.toFixed(1)}/10</div>`)
                                    .addTo(mapInstanceRef.current);
                                markersRef.current.push(marker);
                                bounds.push([coords.lat, coords.lng]);
                            }
                        } catch (error) {
                            console.error("Geocoding error:", error);
                        }
                    }
                    if (bounds.length > 0) {
                        mapInstanceRef.current.fitBounds(bounds, { padding: [50, 50] });
                    }
                };
                addMarkers();
            }, [reviews]);

            return <div ref={mapRef} style={{ height: '500px', width: '100%', marginTop: '20px' }} />;
        };

        function WeExperiences() {
            const [activeTab, setActiveTab] = useState('hotels');
            const [showAddForm, setShowAddForm] = useState(false);
            const [showMap, setShowMap] = useState(false);
            const [reviews, setReviews] = useState({ hotels: [], restaurants: [] });
            const [loading, setLoading] = useState(true);
            const [saving, setSaving] = useState(false);
            const [imageFile, setImageFile] = useState(null);
            const [imagePreview, setImagePreview] = useState('');
            const [editingReview, setEditingReview] = useState(null);
            const [tagInput, setTagInput] = useState('');
            const [selectedTag, setSelectedTag] = useState(null);
            
            const [newReview, setNewReview] = useState({
                name: '',
                location: '',
                rating: 5,
                vibeScore: 2,
                tlRating: 2,
                description: '',
                tags: []
            });

            useEffect(() => {
                loadReviews();
            }, []);

            const loadReviews = async () => {
                try {
                    setLoading(true);
                    const hotelsSnapshot = await db.collection('reviews').where('type', '==', 'hotels').get();
                    const hotelsData = hotelsSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    const restaurantsSnapshot = await db.collection('reviews').where('type', '==', 'restaurants').get();
                    const restaurantsData = restaurantsSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    setReviews({ hotels: hotelsData, restaurants: restaurantsData });
                } catch (error) {
                    console.error("Error loading reviews:", error);
                } finally {
                    setLoading(false);
                }
            };

            const uploadImage = async (file) => {
                if (!file) return null;
                try {
                    const timestamp = Date.now();
                    const fileName = `review-images/${timestamp}_${file.name}`;
                    const storageRef = storage.ref(fileName);
                    await storageRef.put(file);
                    return await storageRef.getDownloadURL();
                } catch (error) {
                    console.error("Error uploading image:", error);
                    throw error;
                }
            };

            const handleAddTag = () => {
                if (tagInput.trim() && !newReview.tags.includes(tagInput.trim().toLowerCase())) {
                    setNewReview({
                        ...newReview,
                        tags: [...newReview.tags, tagInput.trim().toLowerCase()]
                    });
                    setTagInput('');
                }
            };

            const handleRemoveTag = (tagToRemove) => {
                setNewReview({
                    ...newReview,
                    tags: newReview.tags.filter(tag => tag !== tagToRemove)
                });
            };

            const handleEditReview = (review) => {
                setEditingReview(review);
                setNewReview({
                    name: review.name,
                    location: review.location,
                    rating: review.rating,
                    vibeScore: review.vibeScore || 2,
                    tlRating: review.tlRating || 2,
                    description: review.description,
                    tags: review.tags || []
                });
                setImagePreview(review.image || '');
                setShowAddForm(true);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            const handleDeleteReview = async (reviewId) => {
                if (!confirm("Are you sure you want to delete this review?")) return;
                try {
                    await db.collection('reviews').doc(reviewId).delete();
                    await loadReviews();
                    alert("Review deleted successfully!");
                } catch (error) {
                    console.error("Error deleting review:", error);
                    alert("Error deleting review: " + error.message);
                }
            };

            const handleUpdateReview = async () => {
                if (!newReview.name || !newReview.location || !newReview.description) {
                    alert("Please fill in Name, Location, and Description!");
                    return;
                }

                try {
                    setSaving(true);
                    let imageUrl = imagePreview || null;
                    if (imageFile) {
                        try {
                            imageUrl = await uploadImage(imageFile);
                        } catch (error) {
                            console.error("Image upload failed:", error);
                        }
                    }
                    
                    const reviewData = {
                        name: newReview.name,
                        location: newReview.location,
                        rating: newReview.rating,
                        description: newReview.description,
                        tags: newReview.tags,
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    };
                    
                    if (imageUrl) reviewData.image = imageUrl;
                    if (editingReview.type === 'hotels') {
                        reviewData.vibeScore = newReview.vibeScore;
                    } else {
                        reviewData.tlRating = newReview.tlRating;
                    }
                    
                    await db.collection('reviews').doc(editingReview.id).update(reviewData);
                    
                    setNewReview({
                        name: '',
                        location: '',
                        rating: 5,
                        vibeScore: 2,
                        tlRating: 2,
                        description: '',
                        tags: []
                    });
                    setImageFile(null);
                    setImagePreview('');
                    setEditingReview(null);
                    setShowAddForm(false);
                    await loadReviews();
                    alert("Review updated successfully! üéâ");
                } catch (error) {
                    console.error("Error updating review:", error);
                    alert("Error updating review: " + error.message);
                } finally {
                    setSaving(false);
                }
            };

            const handleAddReview = async () => {
                if (editingReview) {
                    await handleUpdateReview();
                    return;
                }

                if (!newReview.name || !newReview.location || !newReview.description) {
                    alert("Please fill in Name, Location, and Description!");
                    return;
                }

                try {
                    setSaving(true);
                    let imageUrl = null;
                    if (imageFile) {
                        try {
                            imageUrl = await uploadImage(imageFile);
                        } catch (error) {
                            console.error("Image upload failed:", error);
                        }
                    }
                    
                    const reviewData = {
                        name: newReview.name,
                        location: newReview.location,
                        rating: newReview.rating,
                        description: newReview.description,
                        tags: newReview.tags,
                        type: activeTab,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    };
                    
                    if (imageUrl) reviewData.image = imageUrl;
                    if (activeTab === 'hotels') {
                        reviewData.vibeScore = newReview.vibeScore;
                    } else {
                        reviewData.tlRating = newReview.tlRating;
                    }
                    
                    await db.collection('reviews').add(reviewData);
                    
                    setNewReview({
                        name: '',
                        location: '',
                        rating: 5,
                        vibeScore: 2,
                        tlRating: 2,
                        description: '',
                        tags: []
                    });
                    setImageFile(null);
                    setImagePreview('');
                    setShowAddForm(false);
                    await loadReviews();
                    alert("Review added successfully! üéâ");
                } catch (error) {
                    console.error("Error adding review:", error);
                    alert("Error adding review: " + error.message);
                } finally {
                    setSaving(false);
                }
            };

            const handleImageChange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    if (file.size > 5 * 1024 * 1024) {
                        alert("Image is too large! Please use an image smaller than 5MB.");
                        return;
                    }
                    setImageFile(file);
                    const reader = new FileReader();
                    reader.onloadend = () => setImagePreview(reader.result);
                    reader.readAsDataURL(file);
                }
            };

            const allReviews = [...reviews.hotels, ...reviews.restaurants];
            const filteredReviews = reviews[activeTab].filter(review => 
                !selectedTag || (review.tags && review.tags.includes(selectedTag))
            );

            return (
                <div style={styles.container}>
                    <header style={styles.header}>
                        <h1 style={styles.headerTitle}>WeExperiences</h1>
                        <p style={styles.headerSubtitle}>Share your hotel and restaurant experiences</p>
                    </header>

                    <nav style={styles.nav}>
                        <button
                            onClick={() => { setActiveTab('hotels'); setShowMap(false); setSelectedTag(null); }}
                            style={styles.navButton(activeTab === 'hotels' && !showMap)}
                        >
                            Hotels ({reviews.hotels.length})
                        </button>
                        <button
                            onClick={() => { setActiveTab('restaurants'); setShowMap(false); setSelectedTag(null); }}
                            style={styles.navButton(activeTab === 'restaurants' && !showMap)}
                        >
                            Restaurants ({reviews.restaurants.length})
                        </button>
                        <button
                            onClick={() => setShowMap(true)}
                            style={styles.navButton(showMap)}
                        >
                            Map View
                        </button>
                    </nav>

                    <main style={styles.main}>
                        {showMap ? (
                            <div>
                                <h2 style={{...styles.formTitle, marginBottom: '20px'}}>
                                    All Locations ({allReviews.length} reviews)
                                </h2>
                                {allReviews.length > 0 ? (
                                    <MapView reviews={allReviews} />
                                ) : (
                                    <p style={{textAlign: 'center', padding: '40px'}}>No reviews yet to display on map</p>
                                )}
                            </div>
                        ) : (
                            <>
                                <div style={styles.addButtonContainer}>
                                    {selectedTag ? (
                                        <div style={{display: 'flex', alignItems: 'center', gap: '15px'}}>
                                            <span style={{...styles.label, margin: 0}}>Filtering by:</span>
                                            <span style={{...styles.tag, cursor: 'default'}}>#{selectedTag}</span>
                                            <button
                                                onClick={() => setSelectedTag(null)}
                                                style={{...styles.button, minWidth: '120px'}}
                                            >
                                                <span style={styles.buttonInner}>Clear Filter</span>
                                            </button>
                                        </div>
                                    ) : (
                                        <div></div>
                                    )}
                                    <button
                                        onClick={() => {
                                            setShowAddForm(!showAddForm);
                                            if (showAddForm) {
                                                setEditingReview(null);
                                                setNewReview({
                                                    name: '', location: '', rating: 5,
                                                    vibeScore: 2, tlRating: 2,
                                                    description: '', tags: []
                                                });
                                                setImageFile(null);
                                                setImagePreview('');
                                                setTagInput('');
                                            }
                                        }}
                                        style={styles.button}
                                        disabled={saving}
                                    >
                                        <span style={styles.buttonInner}>
                                            {showAddForm ? '√ó Cancel' : '+ Add Review'}
                                        </span>
                                    </button>
                                </div>

                                {showAddForm && (
                                    <div style={styles.form}>
                                        <h3 style={styles.formTitle}>
                                            {editingReview ? 'Edit' : 'Add New'} {activeTab === 'hotels' ? 'Hotel' : 'Restaurant'} Review
                                        </h3>
                                        
                                        <div style={{marginBottom: '20px'}}>
                                            <label style={styles.label}>Name *</label>
                                            <input
                                                type="text"
                                                value={newReview.name}
                                                onChange={(e) => setNewReview({ ...newReview, name: e.target.value })}
                                                style={styles.input}
                                                placeholder="Enter name"
                                                disabled={saving}
                                            />
                                        </div>

                                        <div style={{marginBottom: '20px'}}>
                                            <label style={styles.label}>Location *</label>
                                            <input
                                                type="text"
                                                value={newReview.location}
                                                onChange={(e) => setNewReview({ ...newReview, location: e.target.value })}
                                                style={styles.input}
                                                placeholder="City, State"
                                                disabled={saving}
                                            />
                                        </div>

                                        <div style={{marginBottom: '20px'}}>
                                            <label style={styles.label}>Rating: {newReview.rating.toFixed(1)} / 10</label>
                                            <input
                                                type="range"
                                                min="1"
                                                max="10"
                                                step="0.1"
                                                value={newReview.rating}
                                                onChange={(e) => setNewReview({ ...newReview, rating: parseFloat(e.target.value) })}
                                                style={{width: '100%', marginBottom: '10px'}}
                                                disabled={saving}
                                            />
                                            <div style={{display: 'flex', justifyContent: 'space-between', fontSize: '12px', color: '#924720'}}>
                                                <span>1</span><span>2</span><span>3</span><span>4</span><span>5</span>
                                                <span>6</span><span>7</span><span>8</span><span>9</span><span>10</span>
                                            </div>
                                        </div>

                                        {activeTab === 'hotels' ? (
                                            <div style={{marginBottom: '20px'}}>
                                                <label style={styles.label}>Vibe Score: {newReview.vibeScore}/4</label>
                                                <input
                                                    type="range"
                                                    min="1"
                                                    max="4"
                                                    step="1"
                                                    value={newReview.vibeScore}
                                                    onChange={(e) => setNewReview({ ...newReview, vibeScore: parseInt(e.target.value) })}
                                                    style={{width: '100%', marginBottom: '10px'}}
                                                    disabled={saving}
                                                />
                                                <div style={{display: 'flex', justifyContent: 'space-between', fontSize: '12px', color: '#924720'}}>
                                                    <span>1</span><span>2</span><span>3</span><span>4</span>
                                                </div>
                                            </div>
                                        ) : (
                                            <div style={{marginBottom: '20px'}}>
                                                <label style={styles.label}>TL Rating: {'üí®'.repeat(newReview.tlRating)}</label>
                                                <input
                                                    type="range"
                                                    min="1"
                                                    max="4"
                                                    step="1"
                                                    value={newReview.tlRating}
                                                    onChange={(e) => setNewReview({ ...newReview, tlRating: parseInt(e.target.value) })}
                                                    style={{width: '100%', marginBottom: '10px'}}
                                                    disabled={saving}
                                                />
                                                <div style={{display: 'flex', justifyContent: 'space-between', fontSize: '12px'}}>
                                                    <span>üí®</span><span>üí®üí®</span><span>üí®üí®üí®</span><span>üí®üí®üí®üí®</span>
                                                </div>
                                            </div>
                                        )}

                                        <div style={{marginBottom: '20px'}}>
                                            <label style={styles.label}>Description *</label>
                                            <textarea
                                                value={newReview.description}
                                                onChange={(e) => setNewReview({ ...newReview, description: e.target.value })}
                                                style={styles.textarea}
                                                placeholder="Share your experience..."
                                                disabled={saving}
                                            />
                                        </div>

                                        <div style={{marginBottom: '20px'}}>
                                            <label style={styles.label}>Tags (Optional)</label>
                                            <div style={{display: 'flex', gap: '10px', marginBottom: '10px'}}>
                                                <input
                                                    type="text"
                                                    value={tagInput}
                                                    onChange={(e) => setTagInput(e.target.value)}
                                                    onKeyPress={(e) => {
                                                        if (e.key === 'Enter') {
                                                            e.preventDefault();
                                                            handleAddTag();
                                                        }
                                                    }}
                                                    style={{...styles.input, flex: 1, marginBottom: 0}}
                                                    placeholder="e.g., romantic, waterfront"
                                                    disabled={saving}
                                                />
                                                <button
                                                    type="button"
                                                    onClick={handleAddTag}
                                                    style={{...styles.button, minWidth: '100px'}}
                                                    disabled={saving}
                                                >
                                                    <span style={styles.buttonInner}>Add Tag</span>
                                                </button>
                                            </div>
                                            {newReview.tags.length > 0 && (
                                                <div style={{marginTop: '15px'}}>
                                                    {newReview.tags.map((tag, index) => (
                                                        <span
                                                            key={index}
                                                            style={{...styles.tag, cursor: 'default', position: 'relative', paddingRight: '30px'}}
                                                        >
                                                            {tag}
                                                            <button
                                                                type="button"
                                                                onClick={() => handleRemoveTag(tag)}
                                                                style={{
                                                                    position: 'absolute',
                                                                    right: '8px',
                                                                    top: '50%',
                                                                    transform: 'translateY(-50%)',
                                                                    background: 'none',
                                                                    border: 'none',
                                                                    color: '#EDE7D4',
                                                                    fontSize: '16px',
                                                                    cursor: 'pointer',
                                                                    padding: '0',
                                                                    width: '20px',
                                                                    height: '20px',
                                                                }}
                                                                disabled={saving}
                                                            >
                                                                √ó
                                                            </button>
                                                        </span>
                                                    ))}
                                                </div>
                                            )}
                                        </div>

                                        <div style={{marginBottom: '30px'}}>
                                            <label style={styles.label}>Upload Photo (Optional)</label>
                                            <input
                                                type="file"
                                                accept="image/*"
                                                onChange={handleImageChange}
                                                style={{...styles.input, paddingTop: '10px'}}
                                                disabled={saving}
                                            />
                                            {imagePreview && (
                                                <div style={{marginTop: '15px'}}>
                                                    <img 
                                                        src={imagePreview} 
                                                        alt="Preview" 
                                                        style={{width: '150px', height: '150px', objectFit: 'cover', border: '1px solid #e2e2e2'}}
                                                    />
                                                    <button
                                                        onClick={() => {
                                                            setImageFile(null);
                                                            setImagePreview('');
                                                        }}
                                                        style={{
                                                            display: 'block',
                                                            marginTop: '10px',
                                                            background: 'none',
                                                            border: 'none',
                                                            color: '#924720',
                                                            fontSize: '13px',
                                                            cursor: 'pointer',
                                                            textDecoration: 'underline',
                                                        }}
                                                        disabled={saving}
                                                    >
                                                        Remove photo
                                                    </button>
                                                </div>
                                            )}
                                        </div>

                                        <button
                                            onClick={handleAddReview}
                                            disabled={saving}
                                            style={{...styles.button, width: '100%', opacity: saving ? 0.5 : 1}}
                                        >
                                            <span style={styles.buttonInner}>
                                                {saving ? (editingReview ? 'Updating...' : 'Saving...') : (editingReview ? 'Update Review' : 'Submit Review')}
                                            </span>
                                        </button>
                                    </div>
                                )}

                                {loading ? (
                                    <div style={{textAlign: 'center', padding: '60px'}}>
                                        <p style={styles.label}>Loading reviews...</p>
                                    </div>
                                ) : (
                                    <>
                                        <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(400px, 1fr))', gap: '30px'}}>
                                            {filteredReviews.map((review) => (
                                                <div key={review.id} style={styles.reviewCard}>
                                                    {review.image && (
                                                        <img
                                                            src={review.image}
                                                            alt={review.name}
                                                            style={styles.reviewImage}
                                                        />
                                                    )}
                                                    
                                                    <div style={styles.reviewContent}>
                                                        <h3 style={styles.reviewTitle}>{review.name}</h3>
                                                        
                                                        <div style={styles.reviewLocation}>
                                                            <span>üìç</span>
                                                            <span>{review.location}</span>
                                                        </div>

                                                        <div style={styles.reviewRating}>
                                                            <div style={{fontFamily: "'Montserrat', sans-serif", fontSize: '15px', letterSpacing: '2px', color: '#924720'}}>
                                                                ‚≠ê {review.rating.toFixed(1)}/10
                                                            </div>
                                                            {review.type === 'hotels' ? (
                                                                <div style={{fontFamily: "'Montserrat', sans-serif", fontSize: '15px', letterSpacing: '2px', color: '#5673B8'}}>
                                                                    Vibe: {review.vibeScore || 2}/4
                                                                </div>
                                                            ) : (
                                                                <div style={{fontFamily: "'Montserrat', sans-serif", fontSize: '15px', letterSpacing: '2px', color: '#5673B8'}}>
                                                                    TL: {'üí®'.repeat(review.tlRating || 2)}
                                                                </div>
                                                            )}
                                                        </div>

                                                        <p style={styles.reviewDescription}>{review.description}</p>

                                                        {review.tags && review.tags.length > 0 && (
                                                            <div style={{marginBottom: '20px'}}>
                                                                {review.tags.map((tag, index) => (
                                                                    <span
                                                                        key={index}
                                                                        onClick={() => setSelectedTag(tag)}
                                                                        style={styles.tag}
                                                                        onMouseEnter={(e) => e.target.style.opacity = '0.8'}
                                                                        onMouseLeave={(e) => e.target.style.opacity = '1'}
                                                                    >
                                                                        #{tag}
                                                                    </span>
                                                                ))}
                                                            </div>
                                                        )}

                                                        <div style={styles.editDeleteButtons}>
                                                            <button
                                                                onClick={() => handleEditReview(review)}
                                                                style={styles.editButton}
                                                                onMouseEnter={(e) => e.target.style.opacity = '0.65'}
                                                                onMouseLeave={(e) => e.target.style.opacity = '1'}
                                                            >
                                                                <span style={{...styles.buttonInner, padding: '10px 20px'}}>‚úèÔ∏è Edit</span>
                                                            </button>
                                                            <button
                                                                onClick={() => handleDeleteReview(review.id)}
                                                                style={styles.deleteButton}
                                                                onMouseEnter={(e) => e.target.style.opacity = '0.65'}
                                                                onMouseLeave={(e) => e.target.style.opacity = '1'}
                                                            >
                                                                <span style={{...styles.buttonInner, padding: '10px 20px'}}>üóëÔ∏è Delete</span>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>

                                        {filteredReviews.length === 0 && (
                                            <div style={{textAlign: 'center', padding: '60px'}}>
                                                <p style={styles.reviewDescription}>
                                                    {selectedTag 
                                                        ? `No reviews with tag "${selectedTag}". Try a different tag or clear the filter.`
                                                        : 'No reviews yet. Be the first to add one!'}
                                                </p>
                                            </div>
                                        )}
                                    </>
                                )}
                            </>
                        )}
                    </main>

                    <footer style={styles.footer}>
                        <p>&copy; 2024 WeExperiences ‚Äî Share Your Adventures</p>
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<WeExperiences />);
    </script>
</body>
</html>
